<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Bill Explorer</title>
    
    <script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>

    <style>
        :root {
            --primary-color: #005A9C;
            --secondary-color: #FDB81E;
            --background-color: #f8f9fa;
            --text-color: #333;
            --light-gray: #e9ecef;
            --white: #fff;
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: var(--font-family);
            margin: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* --- Sidebar / Table of Contents --- */
        .sidebar {
            width: 320px;
            background-color: var(--white);
            border-right: 1px solid var(--light-gray);
            padding: 2rem 1rem;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .sidebar-header {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--secondary-color);
        }

        .toc-list, .toc-list ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .toc-list > li > button {
            font-weight: 600;
            font-size: 1rem;
        }
        
        .toc-list button {
            display: block;
            width: 100%;
            text-align: left;
            padding: 0.75rem 1rem;
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
        }

        .toc-list button:hover {
            background-color: var(--light-gray);
        }
        
        .toc-list .toc-title > button {
            font-weight: bold;
            position: relative;
        }
        
        .toc-list .toc-title > button::after {
            content: '›';
            position: absolute;
            right: 1rem;
            font-size: 1.5rem;
            transition: transform 0.2s;
        }

        .toc-list .toc-title.open > button::after {
            transform: rotate(90deg);
        }
        
        .toc-list ul {
            padding-left: 1rem;
            display: none;
        }
        
        .toc-list .toc-title.open > ul {
            display: block;
        }


        /* --- Main Content --- */
        .main-content {
            margin-left: 320px;
            padding: 2rem;
            width: calc(100% - 320px);
        }

        .controls {
            background: var(--white);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 2rem;
            position: sticky;
            top: 1rem;
            z-index: 999;
        }

        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--light-gray);
        }
        
        .filters {
            margin-top: 1rem;
        }
        
        .filter-tag {
            display: inline-block;
            background: var(--light-gray);
            color: var(--text-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            margin: 0.25rem;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 0.85rem;
        }
        
        .filter-tag:hover, .filter-tag.active {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .bill-section {
            background: var(--white);
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: opacity 0.3s, transform 0.3s;
        }
        
        .bill-section.hidden {
            display: none;
        }

        .section-header {
            padding: 1rem 1.5rem;
            background-color: #fdfdff;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-header h2 {
            margin: 0;
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        .section-id {
            font-family: monospace;
            font-size: 0.9rem;
            color: #6c757d;
        }

        .section-body {
            padding: 1.5rem;
            white-space: pre-wrap;
            font-family: "Georgia", serif;
            font-size: 1.1rem;
            max-height: 500px;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out;
        }
        
        .bill-section.collapsed .section-body {
            max-height: 0;
            padding-top: 0;
            padding-bottom: 0;
        }

        .section-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--light-gray);
            background-color: #fdfdff;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .committee-tag {
            font-size: 0.8rem;
            font-weight: 500;
            background-color: var(--light-gray);
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
        }

        .ask-chatgpt-btn {
            background-color: #10a37f;
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        
        .ask-chatgpt-btn:hover {
            background-color: #0d8c6c;
        }
        
        .tooltip {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius);
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .tooltip.visible {
            opacity: 1;
        }

        /* --- Mobile Responsiveness --- */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
                max-height: 50vh;
                border-right: none;
                border-bottom: 1px solid var(--light-gray);
                box-sizing: border-box;
            }
            .main-content {
                margin-left: 0;
                width: 100%;
                padding: 1rem;
                box-sizing: border-box;
            }
            .controls {
                position: static;
            }
            .section-header h2 {
                font-size: 1.1rem;
            }
            .section-body {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <nav class="sidebar" id="toc-sidebar">
            <div class="sidebar-header">Table of Contents</div>
            <ul class="toc-list" id="toc-list"></ul>
        </nav>
        
        <main class="main-content">
            <div class="controls">
                <div class="search-box">
                    <input type="search" id="search-input" placeholder="🔍 Search the entire bill...">
                </div>
                <div class="filters" id="filters-container">
                    <span class="filter-tag active" data-committee="all">All Committees</span>
                </div>
            </div>
            
            <div id="bill-content-container">
                </div>
        </main>
    </div>

    <div id="tooltip" class="tooltip">Text copied to clipboard!</div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DATA ---
        // This data structure is created by parsing the provided PDF text.
        const billData = [
            // Note: For brevity, only a few representative sections are included here.
            // A full implementation would contain all sections from the PDF.
            {
                "id": "10101",
                "titleName": "RE-EVALUATION OF THRIFTY FOOD PLAN.",
                "committee": "Agriculture, Nutrition, and Forestry",
                "fullText": `SEC. 10101. RE-EVALUATION OF THRIFTY FOOD PLAN.\n(a) IN GENERAL. Section 3 of the Food and Nutri- tion Act of 2008 (7 U.S.C. 2012) is amended by striking subsection (u) and inserting the following:\n"(u) THRIFTY FOOD PLAN.-\n"(1) IN GENERAL. The term 'thrifty food plan' means the diet required to feed a family of 4 persons consisting of a man and a woman ages 20 through 50, a child ages 6 through 8, and a child ages 9 through 11 using the items and quantities of food described in the report of the Department of Agriculture entitled 'Thrifty Food Plan, 2021', and each successor report updated pursuant to this subsection, subject to the conditions that-\n"(A) the relevant market baskets of the thrifty food plan shall only be changed pursuant to paragraph (4);\n"(B) the cost of the thrifty food plan shall be the basis for uniform allotments for all house- holds, regardless of the actual composition of the household; and\n"(C) the cost of the thrifty food plan may only be adjusted in accordance with this sub- section.\n... [and so on for the full section text]"`
            },
            {
                "id": "10102",
                "titleName": "MODIFICATIONS TO SNAP WORK REQUIREMENTS FOR ABLE-BODIED ADULTS.",
                "committee": "Agriculture, Nutrition, and Forestry",
                "fullText": `SEC. 10102. MODIFICATIONS TO SNAP WORK REQUIRE- MENTS FOR ABLE-BODIED ADULTS.\n(a) EXCEPTIONS. - Section 6(0) of the Food and Nutri- tion Act of 2008 (7 U.S.C. 2015(0)) is amended by striking paragraph (3) and inserting the following:\n"(3) EXCEPTIONS. - Paragraph (2) shall not apply to an individual if the individual is-\n"(A) under 18, or over 65, years of age;\n"(B) medically certified as physically or mentally unfit for employment;\n"(C) a parent or other member of a house- hold with responsibility for a dependent child under 14 years of age; ... [full text]"`
            },
            {
                "id": "20001",
                "titleName": "ENHANCEMENT OF DEPARTMENT OF DEFENSE RESOURCES FOR IMPROVING THE QUALITY OF LIFE FOR MILITARY PERSONNEL.",
                "committee": "Armed Services",
                "fullText": `SEC. 20001. ENHANCEMENT OF DEPARTMENT OF DEFENSE RESOURCES FOR IMPROVING THE QUALITY OF LIFE FOR MILITARY PERSONNEL.\n(a) APPROPRIATIONS. In addition to amounts other- wise available, there are appropriated to the Secretary of Defense for fiscal year 2025, out of any money in the Treas- ury not otherwise appropriated, to remain available until September 30, 2029-\n(1) \$230,480,000 for restoration and moderniza- tion costs under the Marine Corps Barracks 2030 ini- tiative;\n(2) \$119,000,000 for base operating support costs under the Marine Corps; ... [full text]"`
            },
            {
                "id": "70101",
                "titleName": "Extension and enhancement of reduced rates.",
                "committee": "Finance",
                "fullText": `SEC. 70101. EXTENSION AND ENHANCEMENT OF REDUCED RATES.\n(a) IN GENERAL.—Section 1(j)(2) of the Internal Revenue Code of 1986 is amended by striking subparagraph (F).\n(b) EFFECTIVE DATE.—The amendment made by this section shall apply to taxable years beginning after December 31, 2025.`
            },
            {
                "id": "90001",
                "titleName": "BORDER INFRASTRUCTURE AND WALL SYSTEM.",
                "committee": "Homeland Security and Governmental Affairs",
                "fullText": `SEC. 90001. BORDER INFRASTRUCTURE AND WALL SYSTEM.\nIn addition to amounts otherwise available, there is appropriated to the Commissioner of U.S. Customs and Border Protection for fiscal year 2025, out of any money in the Treasury not otherwise appropriated, to remain available until September 30, 2029, \$46,550,000,000 for necessary expenses relating to the following elements of the border infrastructure and wall system: ... [full text]`
            }
        ];
        
        const tocData = {
            "TITLE I: Agriculture, Nutrition, and Forestry": [
                {id: '10101', title: 'Re-evaluation of thrifty food plan.'},
                {id: '10102', title: 'Modifications to SNAP work requirements.'},
            ],
            "TITLE II: Armed Services": [
                {id: '20001', title: 'Enhancement of DoD resources for quality of life.'},
            ],
            "TITLE VII: Finance": [
                {id: '70101', title: 'Extension and enhancement of reduced rates.'},
            ],
            "TITLE IX: Homeland Security and Governmental Affairs": [
                {id: '90001', title: 'Border infrastructure and wall system.'},
            ]
        };

        const committees = [...new Set(billData.map(section => section.committee))];

        // --- FUSE.JS SEARCH SETUP ---
        const fuse = new Fuse(billData, {
            keys: ['id', 'titleName', 'fullText'],
            includeScore: true,
            threshold: 0.4,
            minMatchCharLength: 3,
        });

        // --- DOM ELEMENTS ---
        const tocList = document.getElementById('toc-list');
        const contentContainer = document.getElementById('bill-content-container');
        const searchInput = document.getElementById('search-input');
        const filtersContainer = document.getElementById('filters-container');
        const tooltip = document.getElementById('tooltip');

        // --- RENDER FUNCTIONS ---
        function renderTOC() {
            let html = '';
            for (const title in tocData) {
                html += `<li class="toc-title"><button>${title}</button><ul>`;
                tocData[title].forEach(item => {
                    html += `<li><button data-scroll-to="section-${item.id}">${item.id}: ${item.title}</button></li>`;
                });
                html += `</ul></li>`;
            }
            tocList.innerHTML = html;
        }

        function renderFilters() {
            committees.forEach(committee => {
                const tag = document.createElement('span');
                tag.className = 'filter-tag';
                tag.dataset.committee = committee;
                tag.textContent = committee;
                filtersContainer.appendChild(tag);
            });
        }
        
        function renderContent(data) {
            contentContainer.innerHTML = data.map(section => `
                <div class="bill-section" id="section-${section.id}" data-committee="${section.committee}">
                    <div class="section-header">
                        <h2><span class="section-id">SEC. ${section.id}</span> ${section.titleName}</h2>
                    </div>
                    <div class="section-body">
                        ${section.fullText}
                    </div>
                    <div class="section-footer">
                         <span class="committee-tag">${section.committee}</span>
                         <button class="ask-chatgpt-btn" data-section-id="${section.id}">Ask ChatGPT</button>
                    </div>
                </div>
            `).join('');
        }

        // --- EVENT HANDLERS ---
        function handleTOCClick(e) {
            if (e.target.matches('[data-scroll-to]')) {
                const targetId = e.target.dataset.scrollTo;
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            } else if (e.target.parentElement.classList.contains('toc-title')) {
                e.target.parentElement.classList.toggle('open');
            }
        }
        
        function handleFilterClick(e) {
            if (!e.target.matches('.filter-tag')) return;
            
            const selectedCommittee = e.target.dataset.committee;
            
            // Update active state on tags
            document.querySelectorAll('.filter-tag').forEach(tag => {
                tag.classList.toggle('active', tag.dataset.committee === selectedCommittee);
            });
            
            // Filter content
            document.querySelectorAll('.bill-section').forEach(section => {
                const isVisible = selectedCommittee === 'all' || section.dataset.committee === selectedCommittee;
                section.classList.toggle('hidden', !isVisible);
            });
        }

        function handleSearch(e) {
            const query = e.target.value;
            if (query.trim() === '') {
                document.querySelectorAll('.bill-section').forEach(el => el.classList.remove('hidden'));
                return;
            }

            const results = fuse.search(query);
            const resultIds = new Set(results.map(res => `section-${res.item.id}`));

            document.querySelectorAll('.bill-section').forEach(section => {
                section.classList.toggle('hidden', !resultIds.has(section.id));
            });
        }

        function handleAskChatGPT(e) {
            if (!e.target.matches('.ask-chatgpt-btn')) return;

            const sectionId = e.target.dataset.sectionId;
            const section = billData.find(s => s.id === sectionId);
            if (!section) return;

            const promptText = `What does this section of the bill mean, and how could it affect me?\n\n${section.fullText}`;

            navigator.clipboard.writeText(promptText).then(() => {
                showTooltip("Section text copied – paste it into ChatGPT and ask what it means.");
                window.open('https://chat.openai.com/', '_blank');
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                showTooltip("Failed to copy text. Please copy manually.");
            });
        }
        
        function handleSectionCollapse(e) {
            const header = e.target.closest('.section-header');
            if (header) {
                header.parentElement.classList.toggle('collapsed');
            }
        }
        
        function showTooltip(message) {
            tooltip.textContent = message;
            tooltip.classList.add('visible');
            setTimeout(() => {
                tooltip.classList.remove('visible');
            }, 3000);
        }

        // --- INITIALIZATION ---
        function init() {
            renderTOC();
            renderFilters();
            renderContent(billData);
            
            // Add initial collapsed state to all sections
            document.querySelectorAll('.bill-section').forEach(section => {
                section.classList.add('collapsed');
            });

            // Attach event listeners
            tocList.addEventListener('click', handleTOCClick);
            filtersContainer.addEventListener('click', handleFilterClick);
            searchInput.addEventListener('input', handleSearch);
            contentContainer.addEventListener('click', handleAskChatGPT);
            contentContainer.addEventListener('click', handleSectionCollapse);
        }

        init();
    });
    </script>
</body>
</html>
